<!DOCTYPE html>
<html>
<head>
	<title>Login</title>
	<style>
		@import url('https://fonts.googleapis.com/css2?family=Inter&family=Nunito:wght@500&display=swap');

		/* font-family: 'Inter', sans-serif;
		font-family: 'Nunito', sans-serif; */
		body {
			margin: 0;
			padding: 0;
			background: #111B28;
		}

		#login-form {
			position: absolute;
			top: 50%;
			left: 50%;
			width: 400px;
			padding: 40px;
			transform: translate(-50%, -50%);
			background: linear-gradient(#0B111A, #111B28);
			box-sizing: border-box;
			box-shadow: 0 15px 25px #0DC8F4;
			border-radius: 10px;
			color: white;
			letter-spacing: .2em;
		}

		#login-head {
			text-align: center;
			font-family: 'Inter', sans-serif;
			color: #0DC8F4;
			text-shadow: 0 0 .28rem#0DC8F4;
		}

		#login-details {
			margin-top: 3rem;
		}

		.modal {
			display: none;
			position: fixed;
			z-index: 1;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			overflow: auto;
			background-color: rgba(0, 0, 0, 0.4);
		}

		.modal-content {
			background-color: #fefefe;
			margin: 15% auto;
			padding: 20px;
			border: 1px solid #888;
			width: 80%;
			text-align: center;
		}
	</style>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script>
		$(document).ready(function() {
			// Welcome modal box
			var modal = document.getElementById("welcomeModal");
			modal.style.display = "block";

			// Hide the login form
			$("#login-form").hide();

			// Show the login form on access button click
			$("#access-btn").click(function() {
				$("#login-form").show();
			});

			// Login form submission
			$("#login-form").submit(function(event) {
				event.preventDefault(); // Prevent form submission

				// Retrieve username and password values
				var username = $("input[name='name']").val();
				var password = $("input[name='password']").val();

				// Check if login is locked
				if (localStorage.getItem("loginLocked") === "true") {
					alert("Login is locked for the next 10 minutes. Please try again later.");
					return;
				}

				// Make an AJAX request to validate credentials
				$.ajax({
					url: "prime/credentials.json",
					dataType: "json",
					success: function(data) {
						var credentials = data.credentials;
						var isValid = credentials.some(function(credential) {
							return credential.username === username && credential.password === password;
						});

						if (isValid) {
							alert("Login successful!");
							// Redirect to desired page
							window.location.href = "flex/index.html";
						} else {
							alert("Invalid credentials. Please try again.");

							// Increase login attempts and lock if necessary
							var loginAttempts = localStorage.getItem("loginAttempts") || 0;
							loginAttempts++;
							localStorage.setItem("loginAttempts", loginAttempts);

							if (loginAttempts >= 3) {
								localStorage.setItem("loginLocked", "true");
								setTimeout(function() {
									localStorage.removeItem("loginAttempts");
									localStorage.removeItem("loginLocked");
								}, 600000); // 10 minutes in milliseconds
							}
						}
					},
					error: function() {
						alert("Failed to retrieve credentials.");
					}
				});
			});
		});
	</script>
</head>
<body>
	<div class="modal" id="welcomeModal">
		<div class="modal-content">
			<p>Welcome to the login page!</p>
		</div>
	</div>

	<div id="login-form">
		<div id="login-head">
			<h1>Log.In</h1>
		</div>
		<div id="login-details">
			<form action="">
				<div id="user">
					<input type="text" name="name" placeholder="Username">
				</div>
				<div id="pass">
					<input type="password" name="password" placeholder="Password">
				</div>
				<div id="submit">
					<input type="submit" value="Log-In">
				</div>
			</form>
		</div>
	</div>

	<button id="access-btn">Access</button>
</body>
</html>
